{"version":3,"sources":["webpack:///./src/components/pack/NsfwModal.tsx","webpack:///./src/components/pack/Sticker.tsx","webpack:///./src/components/pack/StickerPackDetail.tsx","webpack:///./src/components/pack/StickerPackError.tsx","webpack:///./src/components/pack/Tag.tsx","webpack:///./src/hooks/use-query.ts"],"names":["NsfwModal","NsfwModalComponent","useState","hiddenNsfwModal","className","role","href","target","rel","to","title","onClick","setHiddenNsfwModal","Sticker","StickerComponent","stickerId","useAsyncEffect","a","Promise","getEmojiForSticker","packId","packKey","getConvertedStickerInPack","setEmoji","setStickerSrc","emoji","src","alt","StickerPackDetail","LinkifyHrefDecorator","decoratedHref","key","StickerPackDetailComponent","useParams","useQuery","setStickerPack","getStickerPack","err","setStickerPackError","source","stickerPack","numStickers","author","stickerPackTags","addToSignalHref","type","name","componentDecorator","tag","sticker","StickerPackError","props","children","Tag","TagComponent","URLSearchParams","useLocation","search"],"mappings":"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","file":"154-cb2eea91da51d443114b.js","sourcesContent":["import {styled} from 'linaria/react';\nimport {Link} from 'react-router-dom';\nimport React, {useState} from 'react';\n\n// ----- Styles ----------------------------------------------------------------\n\nconst NsfwModal = styled.div`\n  & .modal {\n    // Overrides the default display:none\n    display: block;\n  }\n\n  & .nsfw-hide {\n    height: 100%;\n    width: 100%;\n    background-color: white;\n    position: absolute;\n    top: 70px;\n    left: 0;\n    z-index: 200;\n  }\n`;\n\n// ----- Component -------------------------------------------------------------\n\nconst NsfwModalComponent: React.FunctionComponent = () => {\n  const [hiddenNsfwModal, setHiddenNsfwModal] = useState(false);\n\n  /**\n   * Sets 'hiddenNsfwModal' when the 'Show pack' button is clicked.\n   */\n  const onHideNsfwModalClick = () => {\n    setHiddenNsfwModal(true);\n  };\n\n  // ----- Render --------------------------------------------------------------\n\n  return (\n  <NsfwModal>\n    {hiddenNsfwModal ? null :\n    <div className=\"nsfw-hide\">\n      <div className=\"modal\">\n        <div className=\"modal-dialog  modal-dialog-centered\" role=\"document\">\n          <div className=\"modal-content\">\n            <div className=\"modal-header\">\n              <h3 className=\"modal-title\">Content Warning</h3>\n            </div>\n            <div className=\"modal-body\">\n              <p>\n                This pack has been marked <i>Not Safe For Work</i> (<a href=\"https://www.urbandictionary.com/define.php?term=NSFW\" target=\"_blank\" rel=\"noopener noreferrer\">NSFW</a>).\n                <br/>\n                This means that it may contain nudity, sexual content, or other potentially disturbing subject matter.\n              </p>\n              <p>You should not view this pack at work, or with children around.</p>\n            </div>\n            <div className=\"modal-footer\">\n              <Link to=\"/\" className=\"btn btn-secondary\" title=\"Go back home\">\n                Go back home\n              </Link>\n              <button className=\"btn btn-primary\" onClick={onHideNsfwModalClick}>\n              Show the pack\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    }\n  </NsfwModal>\n  );\n};\n\n\nexport default NsfwModalComponent;\n","import React, {useState} from 'react';\nimport {styled} from 'linaria/react';\n// @ts-ignore (No type definitions exist for this package.)\nimport Octicon from 'react-octicon';\nimport useAsyncEffect from 'use-async-effect';\n\nimport {getConvertedStickerInPack, getEmojiForSticker} from 'lib/stickers';\nimport {bp} from 'lib/utils';\n\n\n// ----- Props -----------------------------------------------------------------\n\nexport interface Props {\n  packId: string;\n  packKey: string;\n  stickerId: number;\n}\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst Sticker = styled.div`\n  border: 1px solid rgba(0, 0, 0, .125);\n  border-radius: 4px;\n  position: relative;\n\n  & .emoji {\n    position: absolute;\n    top: 2px;\n    left: 6px;\n    opacity: 0.75;\n  }\n\n  & img {\n    width: 72px;\n    height: 72px;\n    object-fit: contain;\n  }\n\n  @media ${bp('sm')} {\n    & img {\n      width: 128px;\n      height: 128px;\n    }\n  }\n`;\n\n\n// ----- Component -------------------------------------------------------------\n\nconst StickerComponent: React.FunctionComponent<Props> = ({packId, packKey, stickerId}) => {\n  const [emoji, setEmoji] = useState('');\n  const [stickerSrc, setStickerSrc] = useState('');\n\n\n  /**\n   * [Effect] Load sticker data and emoji for the sticker indicated in our\n   * props.\n   */\n  useAsyncEffect(async () => {\n    const [\n      emojiResult,\n      stickerResult\n    ] = await Promise.all([\n      getEmojiForSticker(packId, packKey, stickerId),\n      getConvertedStickerInPack(packId, packKey, stickerId)\n    ]);\n\n    setEmoji(emojiResult);\n    setStickerSrc(stickerResult);\n  }, []);\n\n\n  // ----- Render --------------------------------------------------------------\n\n  if (!emoji || !stickerSrc) {\n    return null; // tslint:disable-line no-null-keyword\n  }\n\n  return (\n    <Sticker className=\"shadow-sm m-3 p-4\">\n      <div className=\"emoji\">{emoji}</div>\n      <img src={stickerSrc} alt=\"Sticker\" />\n    </Sticker>\n  );\n};\n\n\nexport default StickerComponent;\n","import React, {useState} from 'react';\nimport {Link, useParams} from 'react-router-dom';\nimport Linkify from 'react-linkify';\nimport {styled} from 'linaria/react';\nimport {darken} from 'polished';\n// @ts-ignore (No type definitions exist for this package.)\nimport Octicon from 'react-octicon';\nimport useAsyncEffect from 'use-async-effect';\n\nimport {GRAY, SIGNAL_BLUE} from 'etc/colors';\nimport {StickerPack} from 'etc/types';\nimport useQuery from 'hooks/use-query';\nimport {getStickerPack} from 'lib/stickers';\nimport {bp} from 'lib/utils';\n\nimport Sticker from './Sticker';\nimport StickerPackError from './StickerPackError';\nimport Tag from './Tag';\nimport NsfwModal from './NsfwModal';\n\n// ----- Types -----------------------------------------------------------------\n\n/**\n * URL parameters that we expect to have set when this component is rendered.\n */\nexport interface UrlParams {\n  packId: string;\n}\n\n\n// ----- Styles ----------------------------------------------------------------\n\nconst StickerPackDetail = styled.div`\n  background-color: white;\n\n  @media ${bp('sm')} {\n    border-radius: 4px;\n    border: 1px solid ${darken(0.15, GRAY)};\n  }\n\n  & .list-group-item {\n    align-items: center;\n    display: flex;\n    flex-direction: row;\n    font-size: 14px;\n\n    & .octicon {\n      font-size: 20px;\n      margin-right: 20px;\n    }\n  }\n\n  & .octicon-globe {\n    color: ${SIGNAL_BLUE};\n  }\n\n  & .octicon-file-directory {\n    color: ${SIGNAL_BLUE};\n  }\n\n  & .octicon-alert {\n    color: ${SIGNAL_BLUE};\n  }\n\n  & .octicon-star {\n    color: gold;\n  }\n\n  & .octicon-tag {\n    color: ${SIGNAL_BLUE};\n  }\n\n  & .title {\n    font-size: 32px;\n    font-weight: 600;\n  }\n\n  @media ${bp('md')} {\n    & .list-group-item {\n      font-size: inherit;\n\n      & .octicon {\n        font-size: 20px;\n        margin-right: 20px;\n      }\n    }\n\n    & .title {\n      font-size: 42px;\n      font-weight: 600;\n    }\n  }\n\n  & .author {\n    font-size: 16px;\n    font-weight: 400;\n    opacity: 0.6;\n  }\n\n  & strong {\n    font-weight: 600;\n  }\n\n`;\n\n\n// ----- Component -------------------------------------------------------------\n\n/**\n * Custom component for Linkify links that adds \"target\" and \"rel\" attributes.\n */\nfunction LinkifyHrefDecorator(decoratedHref: string, decoratedText: string, key: number) {\n  return (\n    <a href={decoratedHref} key={key} target=\"_blank\" rel=\"noreferrer\">{decoratedText}</a>\n  );\n}\n\n\nconst StickerPackDetailComponent: React.FunctionComponent = () => {\n  // Extract :packId from the URL.\n  const {packId} = useParams<UrlParams>();\n\n  // Extract the optional \"key\" query param from the URL.\n  const key = useQuery().get('key') || undefined;\n\n  // StickerPack object for the requested pack.\n  const [stickerPack, setStickerPack] = useState<StickerPack>();\n\n  // One of many possible error codes we may catch when trying to load or\n  // decrypt a sticker pack. This will be used to determine what error message\n  // to show the user.\n  const [stickerPackError, setStickerPackError] = useState('');\n\n\n  /**\n   * [Effect] Set `stickerPack` when the component mounts.\n   */\n  useAsyncEffect(async () => {\n    try {\n      if (!packId) {\n        return;\n      }\n\n      setStickerPack(await getStickerPack(packId, key));\n    } catch (err) {\n      if (err.code) {\n        setStickerPackError(err.code);\n      }\n    }\n  }, []);\n\n\n  // ----- Render --------------------------------------------------------------\n\n  if (!packId || !stickerPack) {\n    // If an error code has been set, display an error alert to the user.\n    if (stickerPackError) {\n      switch (stickerPackError) {\n        case 'NO_KEY_PROVIDED':\n          return (\n            <StickerPackError>\n              <p>This sticker pack is not listed in the Signal Stickers directory. However, if you have the pack's <strong>key</strong>, you can still preview the sticker pack by supplying a <code>key</code> parameter in the URL.</p>\n              <p>For example: <code>{`/pack/${packId}?key=sticker-pack-key`}</code></p>\n            </StickerPackError>\n          );\n        case 'MANIFEST_DECRYPT':\n          return (\n            <StickerPackError>\n              <p>The provided key is invalid.</p>\n            </StickerPackError>\n          );\n        default:\n          return (\n            <StickerPackError>\n              <p>An unknown error occurred ({stickerPackError}).</p>\n            </StickerPackError>\n          );\n      }\n    }\n\n    // If we don't have an error, we're likely still waiting on an async\n    // operation, so render nothing.\n    return null; // tslint:disable-line no-null-keyword\n  }\n\n  const source = stickerPack.meta.source || 'N/A';\n  const numStickers = stickerPack.manifest.stickers.length;\n  // N.B. Signal allows strings containing only whitespace as authors. In these\n  // cases, use 'Anonymous' instead.\n  const author = stickerPack.manifest.author.trim() ? stickerPack.manifest.author : 'Anonymous';\n  const stickerPackTags = stickerPack.meta.tags || [];\n  const addToSignalHref = `https://signal.art/addstickers/#pack_id=${packId}&pack_key=${stickerPack.meta.key}`;\n\n\n  // TODO: Fix logic around displaying home button to better detect when we're\n  // viewing an unlisted sticker pack.\n  return (\n    <StickerPackDetail className=\"px-1 px-sm-4 py-4 mt-0 mt-sm-5 mb-5\">\n    {stickerPack.meta.nsfw ? <NsfwModal></NsfwModal> : null}\n      <div className=\"row mb-4 flex-column-reverse flex-lg-row\">\n        <div className=\"col-12 col-lg-8 mt-4 mt-lg-0\">\n          <div className=\"title\">{stickerPack.manifest.title}</div>\n          <div className=\"author\">{author}</div>\n        </div>\n        <div className=\"col-12 col-lg-4 d-flex d-lg-block justify-content-between text-md-right\">\n          {stickerPack.meta ? <Link to=\"/\">\n            <button type=\"button\" className=\"btn btn-link mr-2\">\n              Home\n            </button>\n          </Link> : null}\n          <a href={addToSignalHref} target=\"_blank\" rel=\"noreferrer\" title=\"Add to Signal\">\n            <button className=\"btn btn-primary\">\n              <Octicon name=\"plus\" />&nbsp;Add to Signal\n            </button>\n          </a>\n        </div>\n      </div>\n\n      {stickerPack.meta ? <div className=\"row mb-4\">\n        <div className=\"col-12 col-lg-6\">\n          <ul className=\"list-group\">\n            {stickerPack.meta.original ? <li className=\"list-group-item text-wrap text-break\">\n            <Octicon name=\"star\" title=\"Original sticker pack\" /> This pack has been created exclusively for Signal by the artist, from original artworks.\n            </li> : null}\n            <li className=\"list-group-item text-wrap text-break\">\n              <Octicon name=\"globe\" title=\"Source\" />\n              <div>\n                <Linkify componentDecorator={LinkifyHrefDecorator}>{source}</Linkify>\n              </div>\n            </li>\n            <li className=\"list-group-item text-wrap text-break\">\n              <Octicon name=\"file-directory\" title=\"Sticker Count\" />\n              {numStickers}\n            </li>\n            {stickerPack.meta.nsfw ? <li className=\"list-group-item text-wrap text-break\">\n              <Octicon name=\"alert\" title=\"NSFW\" /> <strong>NSFW</strong>\n            </li> : null}\n            <li className=\"list-group-item\">\n              <Octicon name=\"tag\" title=\"Tags\" />\n              <div className=\"text-wrap text-break\">\n                {stickerPackTags.length === 0 ? 'None' : stickerPackTags.map(tag => (<Tag key={tag}>{tag}</Tag>))}\n              </div>\n            </li>\n          </ul>\n        </div>\n      </div> : null}\n\n      <div className=\"row\">\n        <div className=\"col-12\">\n          <div className=\"d-flex flex-wrap justify-content-around\">\n            {stickerPack.manifest.stickers.map(sticker => (<Sticker packId={packId} packKey={stickerPack.meta.key} stickerId={sticker.id} key={sticker.id} />))}\n          </div>\n        </div>\n      </div>\n    </StickerPackDetail>\n  );\n};\n\n\nexport default StickerPackDetailComponent;\n","import React from 'react';\n\n\nconst StickerPackError: React.FunctionComponent = props => {\n  return (\n    <div className=\"p-4 my-4\">\n      <div className=\"row mb-4\">\n        <div className=\"col-10 offset-1 alert alert-danger\">\n          <h3 className=\"alert-heading mt-1 mb-3\">Error</h3>\n          {props.children}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n\nexport default StickerPackError;\n","import React from 'react';\nimport {styled} from 'linaria/react';\n\nimport {SIGNAL_BLUE} from 'etc/colors';\n\n\nconst Tag = styled.span`\n  background-color: ${SIGNAL_BLUE};\n  border-radius: 4px;\n  color: white;\n  display: inline-block;\n  font-size: 14px;\n  font-weight: 400;\n  margin: 2px;\n  padding: 2px 8px;\n  text-transform: capitalize;\n`;\n\n\nconst TagComponent: React.FunctionComponent = props => {\n  return (\n    <Tag>\n      {props.children}\n    </Tag>\n  );\n};\n\n\nexport default TagComponent;\n","import {useLocation} from 'react-router-dom';\n\n\n/**\n * Custom hook for introspecting URL query parameters.\n *\n * Example usage:\n *\n * const query = useQuery();\n * query.get('foo');\n */\nexport default function useQuery() {\n  return new URLSearchParams(useLocation().search);\n}\n"],"sourceRoot":""}